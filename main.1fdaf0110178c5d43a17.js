!function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,o){"use strict";o.r(t);o(1),o(2)},function(e,t,o){},function(e,t,o){"use strict";let n,r,l;function a(e){n.balloon.close(),n.setCenter(e),ymaps.geocode(e).then(e=>e.geoObjects.get(0).getAddressLine()).then(t=>{let o={list:[]};l.list.forEach(t=>{t.coords[0]===e[0]&&t.coords[1]===e[1]&&o.list.push(t)});let n=function(e){const t=document.querySelector("#dropbox-form").innerHTML;return Handlebars.compile(t)(e)}(o),s=document.querySelector("#mainBox");s?s.innerHTML=n:(s=document.createElement("div"),s.id="mainBox",s.innerHTML=n,map.appendChild(s));let i=s.querySelector(".dropbox__overlay");i.style.position="absolute",i.style.left=document.body.offsetWidth/2-290+"px",i.style.top=document.body.offsetHeight/2-150+"px",s.querySelector(".dropbox__title").innerHTML=t;const u=s.querySelector(".dropbox__close"),d=s.querySelector(".myreviews__add");u.addEventListener("click",()=>s.remove()),d.addEventListener("click",t=>{t.preventDefault();let o=s.querySelector(".myreviews__name"),n=s.querySelector(".myreviews__place"),i=s.querySelector(".myreviews__impression"),u={name:o.value,place:n.value,text:i.value,date:(new Date).toJSON().slice(0,10).split("-").reverse().join("."),coords:e};if(u.name&&u.place&&u.text){const e=c(u);r.add(e),l.list.push(u),localStorage.setItem("content",JSON.stringify(l))}else alert("Вы заполнили не все поля");a(e)})}).catch(e=>{console.error(e)})}function c(e){let t=new ymaps.Placemark(e.coords,{place:e.place,comment:e.text,data:e.date},{balloonShadow:!1,balloonPanelMaxMapArea:0,hideIconOnBalloonOpen:!1,preset:"islands#violetDotIcon"});return t.events.add("click",(function(e){try{a(e.get("coords"))}catch(e){console.error(e)}}),t),t}ymaps.ready((function(){n=new ymaps.Map("map",{center:[59.91,30.31],zoom:11},{searchControlProvider:"yandex#search"});const e=ymaps.templateLayoutFactory.createClass('<div class="ballon__header">\n            <div class="title">{{ properties.place }}</div>\n            <button class="address">{{ properties.address }}</button>\n        </div>\n        <div class="ballon__body">{{ properties.comment }}</div>',{build:function(){e.superclass.build.call(this);const t=this.getElement().querySelector(".address"),o=this.getData().geoObject.geometry.getCoordinates();ymaps.geocode(o).then(e=>e.geoObjects.get(0).getAddressLine()).then(e=>{t.innerText=e}),t.addEventListener("click",e=>{e.preventDefault(),a(o)})}});r=new ymaps.Clusterer({preset:"islands#invertedVioletClusterIcons",clusterDisableClickZoom:!0,clusterOpenBalloonOnClick:!0,hideIconOnBalloonOpen:!1,openBalloonOnClick:!0,clusterBalloonContentLayout:"cluster#balloonCarousel",clusterBalloonItemContentLayout:e,clusterBalloonPanelMaxMapArea:0,clusterBalloonContentLayoutWidth:200,clusterBalloonContentLayoutHeight:150,clusterBalloonPagerSize:5}),n.geoObjects.add(r),n.events.add("click",(function(e){try{a(e.get("coords"))}catch(e){console.error(e)}})),n.geoObjects.events.add("click",(function(e){e.get("target").balloon&&(e.preventDefault(),a(e.get("target").geometry.getCoordinates()))})),l=function(){let e=localStorage.getItem("content")||'{"list": []}',t=JSON.parse(e);0!==t.list.length&&t.list.forEach(e=>{const t=c(e);r.add(t)});return t}()}))}]);
//# sourceMappingURL=main.1fdaf0110178c5d43a17.js.map